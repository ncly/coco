fxrate <- read.csv2("data/final_fxrateUSDGBP.csv", header = TRUE, sep=";", dec=",", as.is=TRUE)
fxrate[[1]] <- as.Date(fxrate[[1]])
fxrate <- fxrate[fxrate$date>="2015-03-30" & fxrate$date<="2016-06-30", ]
#coco data GBP
for(i in 1:nrow(cocopriceUSD)){
for(j in 1:nrow(fxrate)){
if(fxrate$date[j] == cocopriceUSD$Date[i]){
cocopriceGBP$High[i] <- cocopriceUSD$High[i]/fxrate$fxrate[j]
}
}
}
#share price data
sharepriceGBP <- read.csv2("data/final_shareprice_HSBC.csv", header = TRUE, sep=";", dec=".", as.is=TRUE)
sharepriceGBP[[1]] <- as.Date(sharepriceGBP[[1]])
sharepriceGBP <- sharepriceGBP[sharepriceGBP$date>="2015-03-30" & sharepriceGBP$date<="2016-06-30", ]
sharepriceGBP <- na.locf(sharepriceGBP)
#alldata
alldata <- matrix(nrow = nrow(cocopriceGBP), ncol = 1)
for(i in 1:nrow(cocopriceGBP)){
for(j in 1:nrow(sharepriceGBP)){
if(sharepriceGBP$date[j] == cocopriceGBP$Date[i]){
alldata[i,1] <- sharepriceGBP$shareprice[j]
}
}
}
#data collection
basic_data <- na.locf(cbind(cocopriceGBP, alldata))
colnames(basic_data) <- c("date","cocoprice","shareprice")
#sigma_E
sharepriceGBP <- read.csv2("data/final_shareprice_HSBC.csv", header = TRUE, sep=";", dec=".", as.is=TRUE)
sharepriceGBP[[1]] <- as.Date(sharepriceGBP[[1]])
sharepriceGBP <- shareprice[sharepriceGBP$date>="2014-03-29" & sharepriceGBP$date<="2016-03-29", ]
sharepriceGBP <- na.locf(sharepriceGBP)
returns <- matrix(nrow=nrow(sharepriceGBP)-1, ncol = 1)
for(z in 1:(nrow(sharepriceGBP)-1)){
returns[z,1] <- as.numeric(sharepriceGBP$shareprice[z]) / as.numeric(sharepriceGBP$shareprice[z + 1]) - 1
}
sigma_E <- sd(returns)
# Fitting Equity Derivative Approach
simulation_coco_price_ed <- matrix(nrow = nrow(basic_data), ncol = 2)
colnames(simulation_coco_price_ed) <- c("date","sim1")
diff_simulation_coco_price_ed <- matrix(nrow = nrow(basic_data), ncol = 2)
colnames(diff_simulation_coco_price_ed) <- c("abssimdiff", "squaredsimdiff")
simRMSE_checker <- 0
simMAE_checker <- 0
fitted_S_star <- 0
plotting_data <- matrix(nrow = nrow(basic_data), ncol=5)
colnames(plotting_data) <- c("date", "coco","ed", "cd", "sa")
plotting_data[,1] <- basic_data[,1]
plotting_data[,2] <- cocopriceGBP$High
for(simS_star in seq(363, 365, 0.01)){
for(counter in 1:nrow(basic_data)){
simulation_coco_price_ed[counter, 1] <- basic_data[counter,1]
simulation_coco_price_ed[counter, 2] <- 1/1.45 * price_coco_ed(t <- 0, T <- 100, S_t <- as.numeric(basic_data$shareprice[counter]), S_star <- simS_star, C_p <- 403.488, c_i <- (6.375/2), r <- 0.022, N <- 100, q <- 0.0443, sigma <- sigma_E, alpha = 1)
diff_simulation_coco_price_ed[counter, 1] <- abs(as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_ed[counter, 2]))
diff_simulation_coco_price_ed[counter, 2] <- ((as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_ed[counter, 2])))^2
}
MAE <- sum(as.numeric(diff_simulation_coco_price_ed[,1]))/nrow(diff_simulation_coco_price_ed)
RMSE <- sqrt(sum(as.numeric(diff_simulation_coco_price_ed[,1])))/nrow(diff_simulation_coco_price_ed)
if(simRMSE_checker > RMSE ||  simRMSE_checker == 0){
simRMSE_checker <- RMSE
simMAE_checker <- MAE
fitted_S_star <- simS_star
plotting_data[,3] <- simulation_coco_price_ed[,2]
}
}
simRMSE_checker_ed <- simRMSE_checker
simMAE_checker_ed <- simMAE_checker
fitted_S_star_ed <- fitted_S_star
# Fitting Credit Derivative Approach
simulation_coco_price_cd <- matrix(nrow = nrow(basic_data), ncol = 2)
colnames(simulation_coco_price_cd) <- c("date","sim1")
diff_simulation_coco_price_cd <- matrix(nrow = nrow(basic_data), ncol = 2)
colnames(diff_simulation_coco_price_cd) <- c("abssimdiff", "squaredsimdiff")
simRMSE_checker <- 0
simMAE_checker <-0
fitted_S_star <- 0
for(simS_star in seq(215, 225, 0.01)){
for(counter in 1:nrow(basic_data)){
simulation_coco_price_cd[counter, 1] <- basic_data[counter,1]
simulation_coco_price_cd[counter, 2] <- 1/1.45 * price_coco_cd(t <- 0, T <- 32, S_t <- as.numeric(basic_data$shareprice[counter]), S_star <- simS_star, C_p <- 403.488, c_i <- (6.375/2), r <- 0.022, N <- 100, q <- 0.0443, sigma <- sigma_E)
diff_simulation_coco_price_cd[counter, 1] <- abs(as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_cd[counter, 2]))
diff_simulation_coco_price_cd[counter, 2] <- ((as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_cd[counter, 2])))^2
}
MAE <- sum(as.numeric(diff_simulation_coco_price_cd[,1]))/nrow(diff_simulation_coco_price_cd)
RMSE <- sqrt(sum(as.numeric(diff_simulation_coco_price_cd[,1])))/nrow(diff_simulation_coco_price_cd)
if(simRMSE_checker > RMSE ||  simRMSE_checker == 0){
simRMSE_checker <- RMSE
simMAE_checker <- MAE
fitted_S_star <- simS_star
plotting_data[,4] <- simulation_coco_price_cd[,2]
}
}
simRMSE_checker_cd <- simRMSE_checker
simMAE_checker_cd <- simMAE_checker
fitted_S_star_cd <- fitted_S_star
# Fitting Structural Approach
simulation_coco_price_sa <- matrix(nrow = nrow(basic_data), ncol = 2)
colnames(simulation_coco_price_sa) <- c("date","sim1")
diff_simulation_coco_price_ed <- matrix(nrow = nrow(basic_data), ncol = 2)
colnames(diff_simulation_coco_price_sa) <- c("abssimdiff", "squaredsimdiff")
simRMSE_checker <- 0
simMAE_checker <- 0
fitted_S_star <- 0
plotting_data <- matrix(nrow = nrow(basic_data), ncol=5)
colnames(plotting_data) <- c("date", "coco","ed", "cd", "sa")
plotting_data[,1] <- basic_data[,1]
plotting_data[,2] <- cocopriceGBP$High
for(simS_star in seq(100, 400, 0.01)){
for(counter in 1:nrow(basic_data)){
simulation_coco_price_sa[counter, 1] <- basic_data[counter,1]
simulation_coco_price_sa[counter, 2] <- 1/1.45 * price_coco_sa(S_t <- as.numeric(basic_data$shareprice[counter]), S_star <- simS_star, C_p <- 403.488, c_i <- (6.375/2), r <- 0.022, N <- 100, q <- 0.0443, sigma <- sigma_E, alpha = 1)
price_coco_sa(T <- 100, nsimulations <- 100, rho <- 0.5, kappa <- 0.04, r_bar <- 0.06, r0 <- 0.03, sigma_r <- 0.05, mu_Y <- 0.00, sigma_Y <- 0.02, lambda <- 2, g <- 0.5, x_hat <- 1.1494, b0 <- 0.0341, p <- 0.8, e_bar <- 0.0681, sigma_A <- 0.0367, x0 <- 1.1364, B <- 1, coupon <- (0.06375/2))
diff_simulation_coco_price_sa[counter, 1] <- abs(as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2]))
diff_simulation_coco_price_sa[counter, 2] <- ((as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2])))^2
}
MAE <- sum(as.numeric(diff_simulation_coco_price_sa[,1]))/nrow(diff_simulation_coco_price_sa)
RMSE <- sqrt(sum(as.numeric(diff_simulation_coco_price_ed[,1])))/nrow(diff_simulation_coco_price_sa)
if(simRMSE_checker > RMSE ||  simRMSE_checker == 0){
simRMSE_checker <- RMSE
simMAE_checker <- MAE
fitted_S_star <- simS_star
plotting_data[,3] <- simulation_coco_price_sa[,2]
}
}
simRMSE_checker_sa <- simRMSE_checker
simMAE_checker_sa <- simMAE_checker
fitted_S_star_sa <- fitted_S_star
write.csv2(plotting_data, file = "data/plottingdata_2.txt")
#relative price development plot data
#alldata$High <- as.numeric(alldata$High)
#alldata$alldata <- as.numeric(alldata$alldata)
#alldata <- alldata[alldata$Date>="2015-03-30" & alldata$Date<="2016-06-30", ]
#alldata$High <- alldata$High / 67.47136
#alldata$alldata <- alldata$alldata / 537.105
#write.csv2(alldata, file="data/final_relativepricedevelopment_HSBC-CoCo.txt")
}
120/542
for(simS_star in seq(363, 365, 0.01)){
for(counter in 1:nrow(basic_data)){
simulation_coco_price_ed[counter, 1] <- basic_data[counter,1]
simulation_coco_price_ed[counter, 2] <- 1/1.45 * price_coco_ed(t <- 0, T <- 100, S_t <- as.numeric(basic_data$shareprice[counter]), S_star <- simS_star, C_p <- 403.488, c_i <- (6.375/2), r <- 0.022, N <- 100, q <- 0.0443, sigma <- sigma_E, alpha = 1)
diff_simulation_coco_price_ed[counter, 1] <- abs(as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_ed[counter, 2]))
diff_simulation_coco_price_ed[counter, 2] <- ((as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_ed[counter, 2])))^2
}
MAE <- sum(as.numeric(diff_simulation_coco_price_ed[,1]))/nrow(diff_simulation_coco_price_ed)
RMSE <- sqrt(sum(as.numeric(diff_simulation_coco_price_ed[,1])))/nrow(diff_simulation_coco_price_ed)
if(simRMSE_checker > RMSE ||  simRMSE_checker == 0){
simRMSE_checker <- RMSE
simMAE_checker <- MAE
fitted_S_star <- simS_star
plotting_data[,3] <- simulation_coco_price_ed[,2]
}
}
simulation_coco_price_sa <- matrix(nrow = nrow(basic_data), ncol = 2)
colnames(simulation_coco_price_sa) <- c("date","sim1")
diff_simulation_coco_price_ed <- matrix(nrow = nrow(basic_data), ncol = 2)
colnames(diff_simulation_coco_price_sa) <- c("abssimdiff", "squaredsimdiff")
simRMSE_checker <- 0
simMAE_checker <- 0
fitted_S_star <- 0
plotting_data <- matrix(nrow = nrow(basic_data), ncol=5)
colnames(plotting_data) <- c("date", "coco","ed", "cd", "sa")
plotting_data[,1] <- basic_data[,1]
plotting_data[,2] <- cocopriceGBP$High
for(simS_star in seq(100, 400, 0.01)){
for(counter in 1:nrow(basic_data)){
simulation_coco_price_sa[counter, 1] <- basic_data[counter,1]
simulation_coco_price_sa[counter, 2] <- 1/1.45 * price_coco_sa(T <- 10, nsimulations <- 100, rho <- 0.5, kappa <- 0.04, r_bar <- 0.06, r0 <- 0.022, sigma_r <- 0.05, mu_Y <- 0.00, sigma_Y <- 0.02, lambda <- 2, g <- 0.5, x_hat <- 1.1494, b0 <- 0.0341, p <- simS_star/403.488, e_bar <- 0.0681, sigma_A <- 0.0367, x0 <- 0.2214022*as.numeric(basic_data$shareprice[counter])/880, B <- 1, coupon <- (0.06375/2))
diff_simulation_coco_price_sa[counter, 1] <- abs(as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2]))
diff_simulation_coco_price_sa[counter, 2] <- ((as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2])))^2
}
MAE <- sum(as.numeric(diff_simulation_coco_price_sa[,1]))/nrow(diff_simulation_coco_price_sa)
RMSE <- sqrt(sum(as.numeric(diff_simulation_coco_price_ed[,1])))/nrow(diff_simulation_coco_price_sa)
if(simRMSE_checker > RMSE ||  simRMSE_checker == 0){
simRMSE_checker <- RMSE
simMAE_checker <- MAE
fitted_S_star <- simS_star
plotting_data[,3] <- simulation_coco_price_sa[,2]
}
}
simRMSE_checker_sa <- simRMSE_checker
simMAE_checker_sa <- simMAE_checker
fitted_S_star_sa <- fitted_S_star
source('StructuralApproach.R')
# Fitting Structural Approach
simulation_coco_price_sa <- matrix(nrow = nrow(basic_data), ncol = 2)
colnames(simulation_coco_price_sa) <- c("date","sim1")
diff_simulation_coco_price_ed <- matrix(nrow = nrow(basic_data), ncol = 2)
colnames(diff_simulation_coco_price_sa) <- c("abssimdiff", "squaredsimdiff")
simRMSE_checker <- 0
simMAE_checker <- 0
fitted_S_star <- 0
plotting_data <- matrix(nrow = nrow(basic_data), ncol=5)
colnames(plotting_data) <- c("date", "coco","ed", "cd", "sa")
plotting_data[,1] <- basic_data[,1]
plotting_data[,2] <- cocopriceGBP$High
for(simS_star in seq(100, 400, 0.01)){
for(counter in 1:nrow(basic_data)){
simulation_coco_price_sa[counter, 1] <- basic_data[counter,1]
simulation_coco_price_sa[counter, 2] <- 1/1.45 * price_coco_sa(T <- 10, nsimulations <- 100, rho <- 0.5, kappa <- 0.04, r_bar <- 0.06, r0 <- 0.022, sigma_r <- 0.05, mu_Y <- 0.00, sigma_Y <- 0.02, lambda <- 2, g <- 0.5, x_hat <- 1.1494, b0 <- 0.0341, p <- simS_star/403.488, e_bar <- 0.0681, sigma_A <- 0.0367, x0 <- 0.2214022*as.numeric(basic_data$shareprice[counter])/880, B <- 1, coupon <- (0.06375/2))
diff_simulation_coco_price_sa[counter, 1] <- abs(as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2]))
diff_simulation_coco_price_sa[counter, 2] <- ((as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2])))^2
}
MAE <- sum(as.numeric(diff_simulation_coco_price_sa[,1]))/nrow(diff_simulation_coco_price_sa)
RMSE <- sqrt(sum(as.numeric(diff_simulation_coco_price_ed[,1])))/nrow(diff_simulation_coco_price_sa)
if(simRMSE_checker > RMSE ||  simRMSE_checker == 0){
simRMSE_checker <- RMSE
simMAE_checker <- MAE
fitted_S_star <- simS_star
plotting_data[,3] <- simulation_coco_price_sa[,2]
}
}
simRMSE_checker_sa <- simRMSE_checker
simMAE_checker_sa <- simMAE_checker
fitted_S_star_sa <- fitted_S_star
eGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2]))
diff_simulation_coco_price_sa[counter, 2] <- ((as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2])))^2
}
MAE <- sum(as.numeric(diff_simulation_coco_price_sa[,1]))/nrow(diff_simulation_coco_price_sa)
RMSE <- sqrt(sum(as.numeric(diff_simulation_coco_price_ed[,1])))/nrow(diff_simulation_coco_price_sa)
if(simRMSE_checker > RMSE ||  simRMSE_checker == 0){
simRMSE_checker <- RMSE
simMAE_checker <- MAE
fitted_S_star <- simS_star
simulation_coco_price_sa[counter, 2] <- 1/1.45 * price_coco_sa(T <- 10, nsimulations <- 100, rho <- 0.5, kappa <- 0.04, r_bar <- 0.06, r0 <- 0.022, sigma_r <- 0.05, mu_Y <- 0.00, sigma_Y <- 0.02, lambda <- 2, g <- 0.5, x_hat <- 1.1494, b0 <- 0.0341, p <- simS_star/403.488, e_bar <- 0.0681, sigma_A <- 0.0367, x0 <- 0.2214022*as.numeric(basic_data$shareprice[counter])/880, B <- 1, coupon <- (0.06375/2))
simulation_coco_price_sa[counter, 2] <- 1/1.45 * price_coco_sa(T <- 10, nsimulations <- 100, rho <- 0.5, kappa <- 0.04, r_bar <- 0.06, r0 <- 0.022, sigma_r <- 0.05, mu_Y <- 0.00, sigma_Y <- 0.02, lambda <- 2, g <- 0.5, x_hat <- 1.1494, b0 <- 0.0341, p <- simS_star/403.488, e_bar <- 0.0681, sigma_A <- 0.0367, x0 <- 0.2214022*as.numeric(basic_data$shareprice[counter])/880, B <- 1, coupon <- (0.06375/2))
simulation_coco_price_sa[counter, 2]
simulation_coco_price_sa[counter, 2] <- 1/1.45 * price_coco_sa(T <- 10, nsimulations <- 100, rho <- 0.5, kappa <- 0.04, r_bar <- 0.06, r0 <- 0.022, sigma_r <- 0.05, mu_Y <- 0.00, sigma_Y <- 0.02, lambda <- 2, g <- 0.5, x_hat <- 1.1494, b0 <- 0.0341, p <- simS_star/403.488, e_bar <- 0.0681, sigma_A <- 0.0367, x0 <- 0.2214022*as.numeric(basic_data$shareprice[counter])/880, B <- 1, coupon <- (0.06375/2))
simulation_coco_price_sa
0.2214022*as.numeric(basic_data$shareprice[counter])/880
880/0.2214022*as.numeric(basic_data$shareprice[counter])
880/0.2214022/as.numeric(basic_data$shareprice[counter])
(880+0.2214022*as.numeric(basic_data$shareprice[counter])/880
(880+0.2214022*as.numeric(basic_data$shareprice[counter]))/880
for(simS_star in seq(100, 400, 0.01)){
for(counter in 1:nrow(basic_data)){
simulation_coco_price_sa[counter, 1] <- basic_data[counter,1]
simulation_coco_price_sa[counter, 2] <- 1/1.45 * price_coco_sa(T <- 10, nsimulations <- 100, rho <- 0.5, kappa <- 0.04, r_bar <- 0.06, r0 <- 0.022, sigma_r <- 0.05, mu_Y <- 0.00, sigma_Y <- 0.02, lambda <- 2, g <- 0.5, x_hat <- 1.1494, b0 <- 0.0341, p <- simS_star/403.488, e_bar <- 0.0681, sigma_A <- 0.0367, x0 <- (880+0.2214022*as.numeric(basic_data$shareprice[counter]))/880, B <- 1, coupon <- (0.06375/2))
diff_simulation_coco_price_sa[counter, 1] <- abs(as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2]))
diff_simulation_coco_price_sa[counter, 2] <- ((as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2])))^2
}
MAE <- sum(as.numeric(diff_simulation_coco_price_sa[,1]))/nrow(diff_simulation_coco_price_sa)
RMSE <- sqrt(sum(as.numeric(diff_simulation_coco_price_ed[,1])))/nrow(diff_simulation_coco_price_sa)
if(simRMSE_checker > RMSE ||  simRMSE_checker == 0){
simRMSE_checker <- RMSE
simMAE_checker <- MAE
fitted_S_star <- simS_star
plotting_data[,3] <- simulation_coco_price_sa[,2]
}
}
simRMSE_checker_sa <- simRMSE_checker
simMAE_checker_sa <- simMAE_checker
fitted_S_star_sa <- fitted_S_star
simulation_coco_price_sa <- matrix(nrow = nrow(basic_data), ncol = 2)
colnames(simulation_coco_price_sa) <- c("date","sim1")
diff_simulation_coco_price_sa <- matrix(nrow = nrow(basic_data), ncol = 2)
colnames(diff_simulation_coco_price_sa) <- c("abssimdiff", "squaredsimdiff")
simRMSE_checker <- 0
simMAE_checker <- 0
fitted_S_star <- 0
plotting_data <- matrix(nrow = nrow(basic_data), ncol=5)
colnames(plotting_data) <- c("date", "coco","ed", "cd", "sa")
plotting_data[,1] <- basic_data[,1]
plotting_data[,2] <- cocopriceGBP$High
for(simS_star in seq(100, 400, 0.01)){
for(counter in 1:nrow(basic_data)){
simulation_coco_price_sa[counter, 1] <- basic_data[counter,1]
simulation_coco_price_sa[counter, 2] <- 1/1.45 * price_coco_sa(T <- 10, nsimulations <- 100, rho <- 0.5, kappa <- 0.04, r_bar <- 0.06, r0 <- 0.022, sigma_r <- 0.05, mu_Y <- 0.00, sigma_Y <- 0.02, lambda <- 2, g <- 0.5, x_hat <- 1.1494, b0 <- 0.0341, p <- simS_star/403.488, e_bar <- 0.0681, sigma_A <- 0.0367, x0 <- (880+0.2214022*as.numeric(basic_data$shareprice[counter]))/880, B <- 1, coupon <- (0.06375/2))
diff_simulation_coco_price_sa[counter, 1] <- abs(as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2]))
diff_simulation_coco_price_sa[counter, 2] <- ((as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2])))^2
}
MAE <- sum(as.numeric(diff_simulation_coco_price_sa[,1]))/nrow(diff_simulation_coco_price_sa)
RMSE <- sqrt(sum(as.numeric(diff_simulation_coco_price_ed[,1])))/nrow(diff_simulation_coco_price_sa)
if(simRMSE_checker > RMSE ||  simRMSE_checker == 0){
simRMSE_checker <- RMSE
simMAE_checker <- MAE
fitted_S_star <- simS_star
plotting_data[,3] <- simulation_coco_price_sa[,2]
}
}
(880+0.2214022*as.numeric(basic_data$shareprice[counter])/880
simulation_coco_price_sa
58/75
1/0.7733
for(simS_star in seq(100, 400, 0.01)){
for(counter in 1:nrow(basic_data)){
simulation_coco_price_sa[counter, 1] <- basic_data[counter,1]
simulation_coco_price_sa[counter, 2] <- 1/1.3 * price_coco_sa(T <- 10, nsimulations <- 100, rho <- 0.5, kappa <- 0.04, r_bar <- 0.06, r0 <- 0.022, sigma_r <- 0.05, mu_Y <- 0.00, sigma_Y <- 0.02, lambda <- 2, g <- 0.5, x_hat <- 1.1494, b0 <- 0.0341, p <- simS_star/403.488, e_bar <- 0.0681, sigma_A <- 0.0367, x0 <- (880+0.2214022*as.numeric(basic_data$shareprice[counter]))/880, B <- 1, coupon <- (0.06375/2))
diff_simulation_coco_price_sa[counter, 1] <- abs(as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2]))
diff_simulation_coco_price_sa[counter, 2] <- ((as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2])))^2
}
MAE <- sum(as.numeric(diff_simulation_coco_price_sa[,1]))/nrow(diff_simulation_coco_price_sa)
RMSE <- sqrt(sum(as.numeric(diff_simulation_coco_price_ed[,1])))/nrow(diff_simulation_coco_price_sa)
if(simRMSE_checker > RMSE ||  simRMSE_checker == 0){
simRMSE_checker <- RMSE
simMAE_checker <- MAE
fitted_S_star <- simS_star
plotting_data[,3] <- simulation_coco_price_sa[,2]
}
}
simulation_coco_price_sa
simRMSE_checker <- 0
simMAE_checker <- 0
fitted_S_star <- 0
plotting_data <- matrix(nrow = nrow(basic_data), ncol=5)
colnames(plotting_data) <- c("date", "coco","ed", "cd", "sa")
plotting_data[,1] <- basic_data[,1]
plotting_data[,2] <- cocopriceGBP$High
for(simS_star in seq(100, 400, 0.01)){
for(counter in 1:nrow(basic_data)){
simulation_coco_price_sa[counter, 1] <- basic_data[counter,1]
simulation_coco_price_sa[counter, 2] <- 1/1.3 * price_coco_sa(T <- 10, nsimulations <- 100, rho <- 0.5, kappa <- 0.04, r_bar <- 0.06, r0 <- 0.022, sigma_r <- 0.05, mu_Y <- 0.00, sigma_Y <- 0.02, lambda <- 2, g <- 0.5, x_hat <- 1.1494, b0 <- 0.0341, p <- simS_star/403.488, e_bar <- 0.0681, sigma_A <- 0.0367, x0 <- (880+0.2214022*as.numeric(basic_data$shareprice[counter]))/880, B <- 1, coupon <- (0.06375/2))
diff_simulation_coco_price_sa[counter, 1] <- abs(as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2]))
diff_simulation_coco_price_sa[counter, 2] <- ((as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2])))^2
}
MAE <- sum(as.numeric(diff_simulation_coco_price_sa[,1]))/nrow(diff_simulation_coco_price_sa)
RMSE <- sqrt(sum(as.numeric(diff_simulation_coco_price_ed[,1])))/nrow(diff_simulation_coco_price_sa)
if(simRMSE_checker > RMSE ||  simRMSE_checker == 0){
simRMSE_checker <- RMSE
simMAE_checker <- MAE
fitted_S_star <- simS_star
plotting_data[,3] <- simulation_coco_price_sa[,2]
}
}
simulation_coco_price_sa
simRMSE_checker <- 0
simMAE_checker <- 0
fitted_S_star <- 0
plotting_data <- matrix(nrow = nrow(basic_data), ncol=5)
colnames(plotting_data) <- c("date", "coco","ed", "cd", "sa")
plotting_data[,1] <- basic_data[,1]
plotting_data[,2] <- cocopriceGBP$High
for(simS_star in seq(100, 400, 0.01)){
for(counter in 1:nrow(basic_data)){
simulation_coco_price_sa[counter, 1] <- basic_data[counter,1]
simulation_coco_price_sa[counter, 2] <- 1/1.3 * price_coco_sa(T <- 10, nsimulations <- 100, rho <- 0.5, kappa <- 0.04, r_bar <- 0.06, r0 <- 0.022, sigma_r <- 0.05, mu_Y <- 0.00, sigma_Y <- 0.02, lambda <- 2, g <- 0.5, x_hat <- 1.1494, b0 <- 0.0341, p <- simS_star/403.488, e_bar <- 0.0681, sigma_A <- 0.0367, x0 <- (880+0.2214022*as.numeric(basic_data$shareprice[counter]))/880, B <- 1, coupon <- (0.06375/2))
diff_simulation_coco_price_sa[counter, 1] <- abs(as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2]))
diff_simulation_coco_price_sa[counter, 2] <- ((as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2])))^2
}
MAE <- sum(as.numeric(diff_simulation_coco_price_sa[,1]))/nrow(diff_simulation_coco_price_sa)
RMSE <- sqrt(sum(as.numeric(diff_simulation_coco_price_ed[,1])))/nrow(diff_simulation_coco_price_sa)
if(simRMSE_checker > RMSE ||  simRMSE_checker == 0){
simRMSE_checker <- RMSE
simMAE_checker <- MAE
fitted_S_star <- simS_star
plotting_data[,3] <- simulation_coco_price_sa[,2]
}
}
# Fitting Structural Approach
simulation_coco_price_sa <- matrix(nrow = nrow(basic_data), ncol = 2)
colnames(simulation_coco_price_sa) <- c("date","sim1")
diff_simulation_coco_price_sa <- matrix(nrow = nrow(basic_data), ncol = 2)
colnames(diff_simulation_coco_price_sa) <- c("abssimdiff", "squaredsimdiff")
simRMSE_checker <- 0
simMAE_checker <- 0
fitted_S_star <- 0
plotting_data <- matrix(nrow = nrow(basic_data), ncol=5)
colnames(plotting_data) <- c("date", "coco","ed", "cd", "sa")
plotting_data[,1] <- basic_data[,1]
plotting_data[,2] <- cocopriceGBP$High
for(simS_star in seq(100, 400, 10)){
for(counter in 1:nrow(basic_data)){
simulation_coco_price_sa[counter, 1] <- basic_data[counter,1]
simulation_coco_price_sa[counter, 2] <- 1/1.3 * price_coco_sa(T <- 10, nsimulations <- 100, rho <- 0.5, kappa <- 0.04, r_bar <- 0.06, r0 <- 0.022, sigma_r <- 0.05, mu_Y <- 0.00, sigma_Y <- 0.02, lambda <- 2, g <- 0.5, x_hat <- 1.1494, b0 <- 0.0341, p <- simS_star/403.488, e_bar <- 0.0681, sigma_A <- 0.0367, x0 <- (880+0.2214022*as.numeric(basic_data$shareprice[counter]))/880, B <- 1, coupon <- (0.06375/2))
diff_simulation_coco_price_sa[counter, 1] <- abs(as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2]))
diff_simulation_coco_price_sa[counter, 2] <- ((as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2])))^2
}
MAE <- sum(as.numeric(diff_simulation_coco_price_sa[,1]))/nrow(diff_simulation_coco_price_sa)
RMSE <- sqrt(sum(as.numeric(diff_simulation_coco_price_ed[,1])))/nrow(diff_simulation_coco_price_sa)
if(simRMSE_checker > RMSE ||  simRMSE_checker == 0){
simRMSE_checker <- RMSE
simMAE_checker <- MAE
fitted_S_star <- simS_star
plotting_data[,3] <- simulation_coco_price_sa[,2]
}
}
simRMSE_checker_sa <- simRMSE_checker
simMAE_checker_sa <- simMAE_checker
fitted_S_star_sa <- fitted_S_star
fitted_S_star_sa
simRMSE_checker_sa
plotting_data
simulation_coco_price_sa
simulation_coco_price_sa
plotting_data
plotting_data[,4] <- simulation_coco_price_sa[,2]
simRMSE_checker
fitted_S_star
simMAE_checker
MAE
RMSE
write.csv2(plotting_data, file = "data/plottingdata_3.txt")
simRMSE_checker <- 0
simMAE_checker <- 0
fitted_S_star <- 0
plotting_data <- matrix(nrow = nrow(basic_data), ncol=5)
colnames(plotting_data) <- c("date", "coco","ed", "cd", "sa")
plotting_data[,1] <- basic_data[,1]
plotting_data[,2] <- cocopriceGBP$High
for(simS_star in seq(363, 365, 0.01)){
for(counter in 1:nrow(basic_data)){
simulation_coco_price_ed[counter, 1] <- basic_data[counter,1]
simulation_coco_price_ed[counter, 2] <- 1/1.45 * price_coco_ed(t <- 0, T <- 100, S_t <- as.numeric(basic_data$shareprice[counter]), S_star <- simS_star, C_p <- 403.488, c_i <- (6.375/2), r <- 0.022, N <- 100, q <- 0.0443, sigma <- sigma_E, alpha = 1)
diff_simulation_coco_price_ed[counter, 1] <- abs(as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_ed[counter, 2]))
diff_simulation_coco_price_ed[counter, 2] <- ((as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_ed[counter, 2])))^2
}
MAE <- sum(as.numeric(diff_simulation_coco_price_ed[,1]))/nrow(diff_simulation_coco_price_ed)
RMSE <- sqrt(sum(as.numeric(diff_simulation_coco_price_ed[,1])))/nrow(diff_simulation_coco_price_ed)
if(simRMSE_checker > RMSE ||  simRMSE_checker == 0){
simRMSE_checker <- RMSE
simMAE_checker <- MAE
fitted_S_star <- simS_star
plotting_data[,3] <- simulation_coco_price_ed[,2]
}
}
RMSE
MAE
MAE
plotting_data[,5] <- simulation_coco_price_sa[,2]
write.csv2(plotting_data, file = "data/plottingdata_3.txt")
for(simS_star in seq(100, 400, 10)){
for(counter in 1:nrow(basic_data)){
simulation_coco_price_sa[counter, 1] <- basic_data[counter,1]
simulation_coco_price_sa[counter, 2] <- 1/1.3 * price_coco_sa(T <- 10, nsimulations <- 1, rho <- 0.5, kappa <- 0.04, r_bar <- 0.06, r0 <- 0.022, sigma_r <- 0.05, mu_Y <- 0.00, sigma_Y <- 0.02, lambda <- 2, g <- 0.5, x_hat <- 1.1494, b0 <- 0.0341, p <- simS_star/403.488, e_bar <- 0.0681, sigma_A <- 0.0367, x0 <- (880+0.2214022*as.numeric(basic_data$shareprice[counter]))/880, B <- 1, coupon <- (0.06375/2))
diff_simulation_coco_price_sa[counter, 1] <- abs(as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2]))
diff_simulation_coco_price_sa[counter, 2] <- ((as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2])))^2
}
MAE <- sum(as.numeric(diff_simulation_coco_price_sa[,1]))/nrow(diff_simulation_coco_price_sa)
RMSE <- sqrt(sum(as.numeric(diff_simulation_coco_price_ed[,1])))/nrow(diff_simulation_coco_price_sa)
if(simRMSE_checker > RMSE ||  simRMSE_checker == 0){
simRMSE_checker <- RMSE
simMAE_checker <- MAE
fitted_S_star <- simS_star
plotting_data[,5] <- simulation_coco_price_sa[,2]
}
}
simRMSE_checker_sa <- simRMSE_checker
simMAE_checker_sa <- simMAE_checker
fitted_S_star_sa <- fitted_S_star
simRMSE_checker_sa
simMAE_checker_sa
for(simS_star in seq(100, 100, 1)){
for(counter in 1:nrow(basic_data)){
simulation_coco_price_sa[counter, 1] <- basic_data[counter,1]
simulation_coco_price_sa[counter, 2] <- 1/1.3 * price_coco_sa(T <- 10, nsimulations <- 1000, rho <- 0.5, kappa <- 0.04, r_bar <- 0.06, r0 <- 0.022, sigma_r <- 0.05, mu_Y <- 0.00, sigma_Y <- 0.02, lambda <- 2, g <- 0.5, x_hat <- 1.1494, b0 <- 0.0341, p <- simS_star/403.488, e_bar <- 0.0681, sigma_A <- 0.0367, x0 <- (880+0.2214022*as.numeric(basic_data$shareprice[counter]))/880, B <- 1, coupon <- (0.06375/2))
diff_simulation_coco_price_sa[counter, 1] <- abs(as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2]))
diff_simulation_coco_price_sa[counter, 2] <- ((as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2])))^2
}
MAE <- sum(as.numeric(diff_simulation_coco_price_sa[,1]))/nrow(diff_simulation_coco_price_sa)
RMSE <- sqrt(sum(as.numeric(diff_simulation_coco_price_ed[,1])))/nrow(diff_simulation_coco_price_sa)
if(simRMSE_checker > RMSE ||  simRMSE_checker == 0){
simRMSE_checker <- RMSE
simMAE_checker <- MAE
fitted_S_star <- simS_star
plotting_data[,5] <- simulation_coco_price_sa[,2]
}
}
counter
simulation_coco_price_sa
1/1.48 * price_coco_sa(T <- 10, nsimulations <- 1000, rho <- 0.5, kappa <- 0.04, r_bar <- 0.06, r0 <- 0.022, sigma_r <- 0.05, mu_Y <- 0.00, sigma_Y <- 0.02, lambda <- 2, g <- 0.5, x_hat <- 1.1494, b0 <- 0.0341, p <- simS_star/403.488, e_bar <- 0.0681, sigma_A <- 0.0367, x0 <- (880+0.2214022*as.numeric(basic_data$shareprice[counter]))/880, B <- 1, coupon <- (0.06375/2))
correlation(1,2)
simRMSE_checker_sa
fitted_S_star_sa
simS_star
for(simS_star in seq(306, 306, 100)){
for(counter in 1:nrow(basic_data)){
simulation_coco_price_sa[counter, 1] <- basic_data[counter,1]
simulation_coco_price_sa[counter, 2] <- 1/1.48 * price_coco_sa(T <- 10, nsimulations <- 1000, rho <- 0.5, kappa <- 0.04, r_bar <- 0.06, r0 <- 0.022, sigma_r <- 0.05, mu_Y <- 0.00, sigma_Y <- 0.02, lambda <- 2, g <- 0.5, x_hat <- 1.1494, b0 <- 0.0341, p <- simS_star/403.488, e_bar <- 0.0681, sigma_A <- 0.0367, x0 <- (880+0.2214022*as.numeric(basic_data$shareprice[counter]))/880, B <- 1, coupon <- (0.06375/2))
diff_simulation_coco_price_sa[counter, 1] <- abs(as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2]))
diff_simulation_coco_price_sa[counter, 2] <- ((as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2])))^2
}
MAE <- sum(as.numeric(diff_simulation_coco_price_sa[,1]))/nrow(diff_simulation_coco_price_sa)
RMSE <- sqrt(sum(as.numeric(diff_simulation_coco_price_ed[,1])))/nrow(diff_simulation_coco_price_sa)
if(simRMSE_checker > RMSE ||  simRMSE_checker == 0){
simRMSE_checker <- RMSE
simMAE_checker <- MAE
fitted_S_star <- simS_star
plotting_data[,5] <- simulation_coco_price_sa[,2]
}
}
1/1.48 * price_coco_sa(T <- 10, nsimulations <- 1000, rho <- 0.5, kappa <- 0.04, r_bar <- 0.06, r0 <- 0.022, sigma_r <- 0.05, mu_Y <- 0.00, sigma_Y <- 0.02, lambda <- 2, g <- 0.5, x_hat <- 1.1494, b0 <- 0.0341, p <- simS_star/403.488, e_bar <- 0.0681, sigma_A <- 0.0367, x0 <- (880+0.2214022*as.numeric(basic_data$shareprice[counter]))/880, B <- 1, coupon <- (0.06375/2))
install.packages(smoother)
install.packages('smoother')
plotting_data
simulation_coco_price_sa
smooth(c(2,2,6,12,1))
smooth(c(2,2,6,12,1,213))
smooth(c(5,2,6,4,6,2,4))
plotting_data
plotting_data[,2]
mean(plotting_data[,5])
mean(as.numeric(plotting_data[,5]))
min(as.numeric(plotting_data[,5]))
max(as.numeric(plotting_data[,5]))
for(simS_star in seq(306, 306, 100)){
for(counter in 1:nrow(basic_data)){
simulation_coco_price_sa[counter, 1] <- basic_data[counter,1]
simulation_coco_price_sa[counter, 2] <- 1/1.48 * price_coco_sa(T <- 100, nsimulations <- 1000, rho <- 0.5, kappa <- 0.04, r_bar <- 0.06, r0 <- 0.022, sigma_r <- 0.05, mu_Y <- 0.00, sigma_Y <- 0.02, lambda <- 2, g <- 0.5, x_hat <- 1.1494, b0 <- 0.0341, p <- simS_star/403.488, e_bar <- 0.0681, sigma_A <- 0.0367, x0 <- (880+0.2214022*as.numeric(basic_data$shareprice[counter]))/880, B <- 1, coupon <- (0.06375/2))
diff_simulation_coco_price_sa[counter, 1] <- abs(as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2]))
diff_simulation_coco_price_sa[counter, 2] <- ((as.numeric(cocopriceGBP[counter,2]) - as.numeric(simulation_coco_price_sa[counter, 2])))^2
}
MAE <- sum(as.numeric(diff_simulation_coco_price_sa[,1]))/nrow(diff_simulation_coco_price_sa)
RMSE <- sqrt(sum(as.numeric(diff_simulation_coco_price_ed[,1])))/nrow(diff_simulation_coco_price_sa)
if(simRMSE_checker > RMSE ||  simRMSE_checker == 0){
simRMSE_checker <- RMSE
simMAE_checker <- MAE
fitted_S_star <- simS_star
plotting_data[,5] <- simulation_coco_price_sa[,2]
}
}
price_coco_sa(T <- 100, nsimulations <- 1000, rho <- 0.5,
